Please forgive my spaghetti code. I do intend to fix it.
